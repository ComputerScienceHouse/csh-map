<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>CSH Floorplan</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <svg id="floorplan" xmlns="http://www.w3.org/2000/svg" viewBox="1464 -458 2772.3 2559">
        <style>
            svg {
                height: 90vh;
            }
            
            .room {
                opacity: 0.5;
                fill: #F70303;
            }
            
            .room:hover {
                fill: purple;
            }
        </style>
        <g id="southSide">
            <path id="nrh-3-3121" class="room" d="M1620.3 1136v111h93v-145h-36v34z" />
            <path id="nrh-3-3111" class="room" d="M1850.3 1028h119v219h-119z" />
            <path id="nrh-3-3107" class="room" d="M1978.3 1028h119v219h-119z" />
            <path id="nrh-3-3103" class="room" d="M2106.3 1028h119v219h-119z" />
            <path id="nrh-3-3099" class="room" d="M2234.3 1028h119v219h-119z" />
            <path id="nrh-3-3095" class="room" d="M2362.3 1028h119v219h-119z" />
            <path id="nrh-3-3091" class="room" d="M2490.3 1028h119v219h-119z" />
            <path id="nrh-3-3087" class="room" d="M2618.3 1028h119v219h-119z" />
            <path id="nrh-3-3086" class="room" d="M2618.3 736h119v219h-119z" />
            <path id="nrh-3-3090" class="room" d="M2490.3 736h119v219h-119z" />
            <path id="nrh-3-3094" class="room" d="M2362.3 736h119v219h-119z" />
            <path id="nrh-3-3098" class="room" d="M2106.3 736h247v219h-247z" />
            <path id="nrh-3-3110" class="room" d="M1850.3 736h119v219h-119z" />
            <path id="nrh-3-3106" class="room" d="M1978.3 736h119v219h-119z" />
            <path id="nrh-3-3115" class="room" d="M1722.3 1028h119v219h-119z" />
            <path id="nrh-3-3962" class="room" d="M1722.3 736h119v219h-119z" />
            <path id="nrh-3-3125" class="room" d="M1464 1083.3h147.3v164H1464z" />
            <path id="nrh-3-3126" class="room" d="M1464 909.3h147.3v164H1464z" />
            <path id="nrh-3-3124" class="room" d="M1464 736h147.3v164H1464z" />
            <path id="nrh-3-3120" class="room" d="M1620.3 736h93v73h-93z" />
        </g>
        <g id="lobby">
            <path id="nrh-3-3082" class="room" d="M2863.3 862V736h-117v207h68v-81z" />
            <path id="nrh-3-3078" class="room" d="M2918.8 862v81h68V736h-117v126z" />
            <path id="nrh-3-3950-1" class="room" d="M2788.8 1160.7h70v70h-70z" />
            <path id="nrh-3-3950-2" class="room" d="M2867.8 1160.7h70v70h-70z" />
            <path id="nrh-3-3080" class="room" d="M2823.3 873h87.3v70h-87.3z" />
        </g>
        <g id="northSide">
            <path id="nrh-3-3074" class="room" d="M2995.8 736h119v219h-119z" />
            <path id="nrh-3-3070" class="room" d="M3123.8 736h119v219h-119z" />
            <path id="nrh-3-3066" class="room" d="M3251.8 736h119v219h-119z" />
            <path id="nrh-3-3058" class="room" d="M3379.8 736h247v219h-247z" />
            <path id="nrh-3-3054" class="room" d="M3635.8 736h119v219h-119z" />
            <path id="nrh-3-3050" class="room" d="M3763.8 736h119v219h-119z" />
            <path id="nrh-3-3961" class="room" d="M3891.8 736h119v219h-119z" />
            <path id="nrh-3-3071" class="room" d="M3123.8 1028h119v219h-119z" />
            <path id="nrh-3-3067" class="room" d="M3251.8 1028h119v219h-119z" />
            <path id="nrh-3-3063" class="room" d="M3379.8 1028h119v219h-119z" />
            <path id="nrh-3-3075" class="room" d="M2995.8 1028h119v219h-119z" />
            <path id="nrh-3-3059" class="room" d="M3507.8 1028h119v219h-119z" />
            <path id="nrh-3-3055" class="room" d="M3635.8 1028h119v219h-119z" />
            <path id="nrh-3-3051" class="room" d="M3763.8 1028h119v219h-119z" />
            <path id="nrh-3-3047" class="room" d="M3891.8 1028h119v219h-119z" />
            <path id="nrh-3-3048" class="room" d="M4083.8 736h152.5v165h-152.5z" />
            <path id="nrh-3-3034" class="room" d="M4083.8 901h153v174h-153z" />
            <path id="nrh-3-3028" class="room" d="M4083.8 1170h153v77h-153z" />
            <path id="nrh-3-3032" class="room" d="M4083.8 1084h153v77h-153z" />
        </g>
        <g id="theL">
            <path id="nrh-3-3024" class="room" d="M4083.8 1260h153v161h-153z" />
            <path id="nrh-3-3020" class="room" d="M4083.8 1430h153v161h-153z" />
            <path id="nrh-3-3016" class="room" d="M4083.8 1600h153v161h-153z" />
            <path id="nrh-3-3012" class="room" d="M4083.8 1770h153v161h-153z" />
            <path id="nrh-3-3025" class="room" d="M3857.8 1260h153v161h-153z" />
            <path id="nrh-3-3021" class="room" d="M3857.8 1430h153v161h-153z" />
            <path id="nrh-3-3017" class="room" d="M3857.8 1600h153v161h-153z" />
            <path id="nrh-3-3013" class="room" d="M3857.8 1770h153v161h-153z" />
            <path id="nrh-3-3009" class="room" d="M3857.8 1940h153v161h-153z" />
            <path id="nrh-3-3960" class="room" d="M4109.8 1940h127v161h-127z" />
            <path id="nrh-3-3008" class="room" d="M4019.8 2042h82.5v59h-82.5z" />
        </g>
        <g id="fish">
            <path id="fish-3-3000" class="room" d="M4083.8 562h153v161h-153z" />
            <path id="fish-3-3001" class="room" d="M3857.8 562h153v161h-153z" />
            <path id="fish-3-3004" class="room" d="M4083.8 392h153v161h-153z" />
            <path id="fish-3-3008" class="room" d="M4083.8 222h153v161h-153z" />
            <path id="fish-3-3961" class="room" d="M3857.8 392h153v161h-153z" />
            <path id="fish-3-3011" class="room" d="M3857.8 222h153v161h-153z" />
            <path id="fish-3-3017" class="room" d="M3857.8 52h153v161h-153z" />
            <path id="fish-3-3021" class="room" d="M3857.8-118h153V43h-153z" />
            <path id="fish-3-3045" class="room" d="M3857.8-288h153v161h-153z" />
            <path id="fish-3-3018" class="room" d="M4083.8-1h153v214h-153z" />
            <path id="fish-3-3023" class="room" d="M4083.8-288h153v214h-153z" />
            <path id="fish-3-3049" class="room" d="M3857.8-458h153v161h-153z" />
            <path id="fish-3-3048" class="room" d="M4083.8-458h153v161h-153z" />
        </g>
    </svg>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.js"></script>
    <script>
        /* regexBldg gets building name from ID
           Ex:  nrh-3-3071  => nrh
                fish-3-3050 => fish
        */
        var regexBldg = /([(a-zA-Z)])\w+/g;
        /* regexNum gets room # from ID
           Ex:  nrh-3-3071  => 3071
                fish-3-3050 => 3050
        */
        var regexNum = /([^(a-zA-Z)-])\w+/g;

        function nrhOrFish(id) {
            /*
            Uses regex, checks if id starts with nrh or fish, or something else
            Example IDs:  nrh-3-3071  => isNrh
                          fish-3-3050 => isFish
                          sol-3-3011  => Neither
            */
            var bldg = id.match(regexBldg);
            var num = id.match(regexNum);
            if (bldg == "nrh") {
                getResidents(num.toString(), function (data) {
                    var parsed_data = JSON.parse(data.responseText);
                    console.log(parsed_data[0]);
                });
            } else if (bldg == "fish") {
                getResidents("F%20" + num.toString(), function (data) {
                    var parsed_data = JSON.parse(data.responseText);
                    console.log(parsed_data[0]);
                });
            } else {
                console.log("Neither NRH nor Fish");
            }
        }

        $('.room').click(function () {
            /*
            Uses jQuery click function,
            gets ID of clicked element
            and calls nrhOrFish w/ ID.
            */
            nrhOrFish(this.id);
        });




        function getResidents(room, callback) {
            url = "https://map.csh.rit.edu/api/get/" + room;
            var request = new XMLHttpRequest();
            request.open("GET", url, true);
            request.onreadystatechange = function () {
                console.log("GET State: " + request.readyState + " - Status: " + request.status);
                if (request.readyState == 4 && request.status == 200) {
                    callback(request);
                }
            }
            request.send(null);
        }
//        getResidents("3071", function (data) {
//            var parsed_data = JSON.parse(data.responseText);
//            console.log(parsed_data[0]);
//        });
    </script>
</body>

</html>